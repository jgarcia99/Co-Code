"use strict";angular.module("coCode",["ngAnimate","ngTouch","ngSanitize","restangular","ui.router","firebase","uiGmapgoogle-maps","pubnub.angular.service"]).config(["$stateProvider","$urlRouterProvider","uiGmapGoogleMapApiProvider",function(e,o,t){t.configure({key:"AIzaSyBzWNQv7IOgloZ8Zq9vbifewV9SZtY2Xa8",v:"3.17",libraries:"weather,geometry,visualization"}),e.state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginCtrl",controllerAs:"app"}).state("choose",{url:"/choose/",templateUrl:"app/choose/choose.html",controller:"ChooseCtrl",controllerAs:"choose"}).state("map",{url:"/map",templateUrl:"app/maps/maps.html",controller:"MapsCtrl"}).state("chat",{url:"/chat",templateUrl:"app/chat/chat.html",controller:"ChatCtrl"}).state("profile",{url:"/profile",templateUrl:"app/userProfile/profile.html",controller:"ProfileCtrl"}),o.otherwise("/login")}]).factory("Auth",["$firebaseObject","$state",function(e,o){function t(o){if(console.log(o),null===o)return null;{var t=n.child(o.github.id);o.github.cachedUserProfile}return t.update({uid:o.github.id,gh:o.github,name:o.github.displayName,handle:o.github.username,photo:o.github.cachedUserProfile.avatar_url,email:o.github.cachedUserProfile.email,followers:o.github.cachedUserProfile.followers,following:o.github.cachedUserProfile.following,company:o.github.cachedUserProfile.company,location:o.github.cachedUserProfile.location,url:o.github.cachedUserProfile.html_url}),t=e(n.child(o.github.id))}var n=new Firebase("https://co-code.firebaseio.com/users");return{onAuth:function(e){n.onAuth(function(o){e(t(o))})},twitLogin:function(){return n.authWithOAuthPopup("twitter",function(e,t){console.log(t),e?console.log("Login Failed!",e):(o.go("choose"),console.log("Authenticated successfully with payload:",t))},{remember:"sessionOnly",scope:"user,gist"})},ghLogin:function(){return n.authWithOAuthPopup("github",function(e,t){console.log(t),e?console.log("Login Failed!",e):(o.go("choose"),console.log("Authenticated successfully with payload:",t))},{remember:"sessionOnly"})},logout:function(){n.unauth(),console.log("hello")},loggedIn:function(){return n.getAuth()?!0:void 0}}}]),angular.module("coCode").controller("ProfileCtrl",["$state","$firebaseObject","$scope","$firebaseArray","$stateParams","Auth",function(e,o,t,n,l,a){a.onAuth(function(e){t.user=e,console.log(null===e?"null":e)})}]),angular.module("coCode").controller("MapsCtrl",["$scope",function(e){e.map={center:{latitude:28.593178,longitude:-81.361418},zoom:11},e.coffeeMarkers=[{id:1,latitude:28.593178,longitude:-81.361418,icon:"/assets/images/co-code-logo_720.png",options:{labelContent:"hello"}},{id:2,latitude:28.568422,longitude:-81.346529,options:{labelContent:"hello"}},{id:3,latitude:28.571854,longitude:-81.389863,options:{labelContent:"hello"}},{id:4,latitude:28.549242,longitude:-81.352306,options:{labelContent:"hello"}},{id:5,latitude:28.555688,longitude:-81.207649,options:{labelContent:"hello"}}]}]),angular.module("coCode").controller("LoginCtrl",["$firebaseArray","$firebaseObject","Auth",function(e,o,t){var n=this,l=new Firebase("https://co-code.firebaseio.com/users");this.obj=e(l),this.userArray={},this.ghLogin=t.ghLogin,t.onAuth(function(e){n.user=e,console.log(null===e?"null":e)})}]),angular.module("coCode").controller("ChatCtrl",["$rootScope","$firebaseObject","$firebaseArray","$location","Auth","$scope","PubNub",function(e,o,t,n,l,a,i){l.onAuth(function(e){a.user=e,console.log(null===e?"null":e)}),a.subscriptions={FrontEnd:!0,Backend:!1},a.messages=["Welcome to "+a.channel],e.initialized||(i.init({subscribe_key:"sub-c-f24f7cc2-cc35-11e4-b37f-02ee2ddab7fe",publish_key:"pub-c-7d9dc0ae-e3d1-4eed-b24e-806a9bc730af",uuid:a.userId}),e.initialized=!0),i.ngSubscribe({channel:a.channel}),a.publish=function(){i.ngPublish({channel:a.channel,message:"["+a.userId+"] "+a.newMessage}),a.newMessage=""},e.$on(i.ngMsgEv(a.channel),function(e,o){a.$apply(function(){a.messages.push(o.message)})}),e.$on(i.ngPrsEv(a.channel),function(){a.$apply(function(){a.users=i.ngListPresence(a.channel)})}),i.ngHereNow({channel:a.channel}),i.ngHistory({channel:a.channel,count:500})}]),angular.module("coCode").controller("ChooseCtrl",["$state","$firebaseObject","$scope","$firebaseArray","$stateParams","Auth",function(e,o,t,n,l,a){var i=(new Firebase("https://co-code.firebaseio.com/"),new Firebase("https://co-code.firebaseio.com/users/userchoice/"));a.onAuth(function(e){t.user=e,console.log(null===e?"null":e)}),t.obj=n(i),console.log(t.obj),t.userInfo={},t.userInfo={reason:"Talk",tech:"Back-end"},t.addUserInfo=function(e){return t.obj.$add(e),e={reason:"user.reason",tech:"user.tech"}}}]),angular.module("coCode").run(["$templateCache",function(e){e.put("app/chat/chat.html",'<div class="container" ng-controller="ChatCtrl"><h2>Co-Code Orlando Chat</h2><h4>Online Users</h4><ul><li ng-repeat="user in users">{{user}}</li></ul><div class="well"><ul><li ng-repeat="message in messages">{{message}}</li></ul></div><form ng-submit="publish()"><input type="text" ng-model="newMessage"> <input type="submit" value="Send"></form></div>'),e.put("app/choose/choose.html",'<div class="container"><main class="choose-reason" ng-controller="ChooseCtrl as choose"><h2>Hey <span class="handle-name">@{{user.handle}}</span> are you going to the cafe to:</h2><div ng-init="reason = \'Code\'"><form name="myReason"><input type="radio" ng-model="reason" value="Code"> Code<br><input type="radio" ng-model="reason" value="Talk"> Talk (You forgot your MacBook)<br></form></div><div data-ng-init="tech = \'Front-end\'"></div><h2>I like to talk/code about:</h2><input type="radio" ng-model="tech" value="Front-end">Front-end<br><input type="radio" ng-model="tech" value="Back-end">Back-end<br><input type="radio" ng-model="tech" value="Mobile">Mobile<br><input type="radio" ng-model="tech" value="Web Design">Web Design<br><h4>So @{{user.handle}} is going to the cafe to {{reason}} about {{tech}} cool.</h4><button ng-submit="choose.userInfo()">Next</button></main></div>'),e.put("app/login/login.html",'<div class="container"><input class="login username" type="text" value="" placeholder="Username"> <input class="login password" type="password" placeholder="Password"> <button class="submit"><a ui-sref="choose"><i class="fa fa-arrow-right"></i></a></button><div class="options text-center"><span class="twitter" ng-click="app.twitLogin()"><a href=""><i class="fa fa-twitter fa-5x"></i></a></span> <span class="github" ng-click="app.ghLogin()"><a href=""><i class="fa fa-github fa-5x"></i></a></span></div></div>'),e.put("app/maps/maps.html",'<div class="container" ng-controller="MapsCtrl"><h2>Top 5 coffee shops in Orlando</h2><ui-gmap-google-map center="map.center" zoom="map.zoom"><ui-gmap-markers models="coffeeMarkers" coords="\'self\'" icon="icon" options="\'map.options\'" click="\'onClicked\'"></ui-gmap-markers></ui-gmap-google-map></div>'),e.put("app/userProfile/profile.html",'<div class="container main-profile" ng-controller="ProfileCtrl"><h2 class="text-center">Profile</h2><div class="user-photo col-md-3 col-md-offset-3"><img ng-src="{{user.photo}}"></div><div class="user-info col-md-3 col-md-offset-3"><p>Username: {{user.handle}}</p><p>Name: {{user.name}}</p><p>Followers: {{user.followers}}</p><p>Following: {{user.following}}</p><p>location: {{user.location}}</p><p>Company: {{user.company}}</p><p>URL: <a href="{{user.url}}">{{user.url}}</a></p><p>Email: {{user.email}}</p></div></div>')}]);